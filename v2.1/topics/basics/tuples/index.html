<!DOCTYPE html>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="DataStax C++ Driver for Apache Cassandra Documentation">
    <meta name="author" content="DataStax">

    <title>DataStax C/C++ Driver - Tuples</title>

    <link rel="icon" href="../../../../favicon.ico">
    <link rel="apple-touch-icon" href="../../../../favicon.png">
    <link href="../../../../css/style.css" rel="stylesheet">
    <link href="../../../../css/pygments.css" rel="stylesheet">
    <link href="../../../../css/hotkeys.css" rel="stylesheet">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body ng-app="docs">
    <div class="navbar">
      <div class="container-fluid">
        <div class="row row-offcanvas row-offcanvas-left">
          <div class="col-sm-3 text-center">
            <a class="ds-home" href="../../../"><img alt="Brand" src="../../../../img/logo.png"></a>
            <ul class="list-inline ds-sites" role="nav">
              <li><a href="https://academy.datastax.com/" class="navbar-link">DataStax Academy</a></li>
              <li><a href="http://www.datastax.com/dev/blog" class="navbar-link">Tech Blog</a></li>
              <li><a href="http://www.datastax.com/what-we-offer/products-services/support" class="navbar-link">Support</a></li>
            </ul>
          </div>
          <div class="col-md-5">
            <p class="lead pubtitle">DataStax C/C++ Driver</p>
            
            <div class="text-info">
              <span class="text-warning">Attention:</span> Viewing documentation for version
              <div class="btn-group">
                <button id="current-version" class="btn btn-default btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  v2.1
                  <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu" aria-labelledby="current-version">
                
                  <li><a href="../../../../">v2.4</a></li>
                
                  <li><a href="../../../../v2.3/topics/basics/tuples/">v2.3</a></li>
                
                  <li><a href="../../../../v2.2/topics/basics/tuples/">v2.2</a></li>
                
                  <li class="disabled"><a href="./">v2.1</a></li>
                
                  <li><a href="../../../../v2.0/">v2.0</a></li>
                
                  <li><a href="../../../../v1.0/">v1.0</a></li>
                
                </ul>
              </div>
            </div>
            
          </div>
          <div class="col-md-4">
            <form id="search" class="form-search dropdown visible-lg-inline-block" ng-controller="search" ng-class="{open: hasResults}" role="search" ng-submit="submit()" data-spy="affix" data-offset-top="130">
              <div class="form-group has-feedback">
                <input type="search" class="form-control input-sm mousetrap" placeholder="Search..." ng-model="q" ng-change="search('v2.1')" ng-disabled="!searchReady" disabled data-hotkey="{down: moveDown, up: moveUp, esc: reset}" data-search>
              </div>
              <ul class="dropdown-menu search-results" role="menu">
                <li ng-repeat="result in results" ng-class="{'bg-warning': $index == current}"><a ng-href="{{basePath}}{{result.path}}"><span ng-bind-html="summary(result)"></span></a></li>
              </ul>
            </form>
            <a href="http://www.datastax.com/download" class="btn btn-primary btn-sm">Download</a>
          </div>
        </div>
      </div>
    </div>

    <div class="container-fluid" id="content">
      <div class="row">
        <div class="col-md-3">
          <div id="navigation" class="side-nav" role="tablist" aria-multiselectable="true">
            <h3><a href="../../../">Contents</a></h3>
            <ul class="nav nav-pills nav-stacked">
  
  
  <li class="active">
    <a href="../../">
      Getting Started <small>page</small>
      
      
      <span class="glyphicon glyphicon-minus-sign pull-right" aria-hidden="true"></span>
      
      
    </a>
    <ul class="nav nav-pills nav-stacked">
  
  
  <li>
    <a href="../../building/">
      Building <small>page</small>
      
    </a>
    
  </li>
  
  
  <li class="active">
    <a href="../">
      Basics <small>page</small>
      
      
      <span class="glyphicon glyphicon-minus-sign pull-right" aria-hidden="true"></span>
      
      
    </a>
    <ul class="nav nav-pills nav-stacked">
  
  
  <li>
    <a href="../keyspaces/">
      Keyspaces <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../futures/">
      Futures <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../binding_parameters/">
      Binding Parameters <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../handling_results/">
      Handling Results <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../schema_metadata/">
      Schema Metadata <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../uuids/">
      UUIDs <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../batches/">
      Batches <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../client_side_timestamps/">
      Client-side timestamps <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../consistency/">
      Consistency <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../data_types/">
      Data Types <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../prepared_statements/">
      Prepared Statements <small>page</small>
      
    </a>
    
  </li>
  
  
  <li class="active">
    <a href="./" class="current">
      Tuples <small>page</small>
      
    </a>
    <ul class="nav nav-pills nav-stacked">
  
</ul>

  </li>
  
  
  <li>
    <a href="../user_defined_types/">
      User Defined Types (UDTs) <small>page</small>
      
    </a>
    
  </li>
  
</ul>

  </li>
  
  
  <li>
    <a href="../../security/">
      Security <small>page</small>
      
      
      <span class="glyphicon glyphicon-plus-sign pull-right" aria-hidden="true"></span>
      
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../../logging/">
      Logging <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../../configuration/">
      Configuration <small>page</small>
      
      
      <span class="glyphicon glyphicon-plus-sign pull-right" aria-hidden="true"></span>
      
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../../faq/">
      FAQ <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../../metrics/">
      Metrics <small>page</small>
      
    </a>
    
  </li>
  
  
  <li>
    <a href="../../testing/">
      Testing <small>page</small>
      
      
      <span class="glyphicon glyphicon-plus-sign pull-right" aria-hidden="true"></span>
      
      
    </a>
    
  </li>
  
</ul>

  </li>
  
  
  <li>
    <a href="../../../api/">
      API docs <small>index</small>
      
      
      <span class="glyphicon glyphicon-plus-sign pull-right" aria-hidden="true"></span>
      
      
    </a>
    
  </li>
  
</ul>

          </div>
        </div>
        <div class="col-md-9 content">
          <div class="crumbs-wrapper">
            <nav id="crumbs" data-spy="affix" data-offset-top="130">
              <ol class="breadcrumb">
                
                
                
                <li><a href="../../../">Home</a></li>
                
                
                
                
                
                <li><a href="../../">Getting Started</a></li>
                
                
                
                
                
                <li><a href="../">Basics</a></li>
                
                
                
                
                
                <li class="active">Tuples</li>
                
                
                
              </ol>
            </nav>
          </div>
          

<h1 id="tuples" class="target">Tuples<a class="anchor" href="#tuples" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h1>

<p>Tuples are fixed-length sets of values. They are similar to UDTs in that they
can contain different types of values, but unlike UDTs tuples can only be
accessed by position and not by name.</p>

<h2 id="creating-a-tuple" class="target">Creating a Tuple<a class="anchor" href="#creating-a-tuple" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h2>

<p>Creating a <a href="http://datastax.github.io/cpp-driver/api/CassTuple/"><code>CassTuple</code></a> is done by allocating a new tuple object with the
number of items that will be contained in it. Items can the be set in the tuple
using their position.</p>
<pre class="highlight"><code><span class="cm">/* The number of items must be set properly */</span>
<span class="nc">CassTuple</span><span class="o">*</span> <span class="n">tuple</span> <span class="o">=</span> <span class="nb">cass_tuple_new</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="cm">/* Items are set by position */</span>
<span class="nb">cass_tuple_set_string</span><span class="p">(</span><span class="n">tuple</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"abc"</span><span class="p">);</span>
<span class="nb">cass_tuple_set_int64</span><span class="p">(</span><span class="n">tuple</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>

<span class="cm">/* ... */</span>

<span class="cm">/* Tuples must be freed */</span>
<span class="nb">cass_tuple_free</span><span class="p">(</span><span class="n">tuple</span><span class="p">);</span>
</code></pre>
<h2 id="create-a-tuple-using-a-data-type" class="target">Create a Tuple using a Data Type<a class="anchor" href="#create-a-tuple-using-a-data-type" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h2>

<p>A tuple can also be created using a [<code>CassDataType</code>] that comes from schema
metadata or is manually constructed. However, this is not step necessary as
a tuple can be created without a data type. A typed tuple will not allow invalid
type to be added to it. <a href="http://datastax.github.io/cpp-driver/api/CassTuple/#cass-tuple-set-null"><code>cass_tuple_set_*()</code></a> functions will return an error
code if the incorrect type is added to a position.</p>
<pre class="highlight"><code><span class="cm">/* Creata new tuple data type */</span>
<span class="nc">CassDataType</span><span class="o">*</span> <span class="n">data_type</span> <span class="o">=</span> <span class="nb">cass_data_type_new_tuple</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="cm">/* Add a string at position 0 and an 64-bit integer at position 1 */</span>
<span class="nb">cass_data_type_add_sub_value_type</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">CASS_VALUE_TYPE_TEXT</span><span class="p">);</span>
<span class="nb">cass_data_type_add_sub_value_type</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">CASS_VALUE_TYPE_BIGINT</span><span class="p">);</span>

<span class="cm">/* Create a new tuple using data type */</span>
<span class="nc">CassTuple</span><span class="o">*</span> <span class="n">tuple</span> <span class="o">=</span> <span class="nb">cass_tuple_new_from_data_type</span><span class="p">(</span><span class="n">data_type</span><span class="p">);</span>

<span class="cm">/* This will now return an error because the data type of the first item is
 * a string not an integer
 */</span>
<span class="nc">CassError</span> <span class="n">rc</span> <span class="o">=</span> <span class="nb">cass_tuple_set_int32</span><span class="p">(</span><span class="n">tuple</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>

<span class="n">assert</span><span class="p">(</span><span class="n">rc</span> <span class="o">!=</span> <span class="n">CASS_OK</span><span class="p">);</span>

<span class="cm">/* These are the correct types */</span>
<span class="nb">cass_tuple_set_string</span><span class="p">(</span><span class="n">tuple</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"abc"</span><span class="p">);</span>
<span class="nb">cass_tuple_set_int64</span><span class="p">(</span><span class="n">tuple</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>

<span class="cm">/* ... */</span>

<span class="cm">/* Constructed data types must be freed */</span>
<span class="nb">cass_data_type_free</span><span class="p">(</span><span class="n">data_type</span><span class="p">);</span>

<span class="cm">/* Tuples must be freed */</span>
<span class="nb">cass_tuple_free</span><span class="p">(</span><span class="n">tuple</span><span class="p">);</span>
</code></pre>
<h2 id="consuming-values-from-a-tuple-result" class="target">Consuming values from a Tuple result<a class="anchor" href="#consuming-values-from-a-tuple-result" aria-hidden="true"><span class="glyphicon glyphicon-link"></span></a>
</h2>

<p><a href="http://datastax.github.io/cpp-driver/api/CassTuple/"><code>CassTuple</code></a>s are consumed using an iterator.</p>
<pre class="highlight"><code><span class="cm">/* Retrieve tuple value from column */</span>
<span class="k">const</span> <span class="nc">CassValue</span><span class="o">*</span> <span class="n">tuple_value</span> <span class="o">=</span> <span class="nb">cass_row_get_column_by_name</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s">"value1"</span><span class="p">);</span>

<span class="cm">/* Create an iterator for the UDT value */</span>
<span class="nc">CassIterator</span><span class="o">*</span> <span class="n">tuple_iterator</span> <span class="o">=</span> <span class="nb">cass_iterator_from_tuple</span><span class="p">(</span><span class="n">tuple_value</span><span class="p">);</span>

<span class="cm">/* Iterate over the tuple fields */</span>
<span class="k">while</span> <span class="p">(</span><span class="nb">cass_iterator_next</span><span class="p">(</span><span class="n">tuple_iterator</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">field_name</span><span class="p">;</span>
  <span class="kt">size_t</span> <span class="n">field_name_length</span><span class="p">;</span>
  <span class="cm">/* Get tuple value */</span>
  <span class="k">const</span> <span class="nc">CassValue</span><span class="o">*</span> <span class="n">value</span> <span class="o">=</span> <span class="nb">cass_iterator_get_value</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

  <span class="cm">/* ... */</span>
<span class="p">}</span>

<span class="cm">/* The tuple iterator needs to be freed */</span>
<span class="nb">cass_iterator_free</span><span class="p">(</span><span class="n">tuple_iterator</span><span class="p">);</span>
</code></pre>


        </div>
      </div>
    </div>

    

    <script src="../../../../js/jquery.js"></script>
    <script src="../../../../js/bootstrap.js"></script>
    <script src="../../../../js/angular.js"></script>
    <script src="../../../../js/mousetrap.js"></script>
    <script src="../../../../js/hotkeys.js"></script>
    <script src="../../../../js/ZeroClipboard.js"></script>
    <script src="../../../../js/lunr.js"></script>
    <script src="../../../../js/app.js"></script>
  </body>
</html>
